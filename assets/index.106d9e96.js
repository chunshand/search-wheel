import{c as S,q as d,o as k,e as z,w as s,f as a,i as w,g as e,x as B,a2 as U,D as b,I as E,a3 as P,J as $,n as p,a4 as q,S as G,H as W,l as V,U as L,A as O,G as I,h as K,a5 as M,Q as H,P as R,W as j,V as J,a6 as A,B as Q}from"./vendor.67b40587.js";import{g as X,a as Y,s as Z,b as ee}from"./index.45414d3c.js";import{g as te}from"./tag.72498485.js";const ae={class:"w-10"},le=p("\u72B6\u6001"),ue={class:"w-32"},ne={class:"w-10"},se=p("\u72B6\u6001"),oe={class:"w-64"},ie=p("\u641C\u7D22"),de=S({emits:["select"],setup(C,{emit:g}){const _=d([{label:"\u4E0A\u7EBF",value:"online"},{label:"\u5F85\u5BA1\u6838",value:"default"},{label:"\u5DF2\u5220\u9664",value:"del"}]),o=d("online"),l=d(""),y=()=>{q(()=>{m()})},m=()=>{g("select",{content:l.value,state:o.value})};return(f,r)=>(k(),z(e(b),{vertical:""},{default:s(()=>[a(e(b),{align:"center"},{default:s(()=>[w("div",ae,[a(e(B),null,{default:s(()=>[le]),_:1})]),w("div",ue,[a(e(U),{value:o.value,"onUpdate:value":r[0]||(r[0]=h=>o.value=h),options:_.value,size:"large",onChange:y},null,8,["value","options"])])]),_:1}),a(e(b),{align:"center"},{default:s(()=>[w("div",ne,[a(e(B),null,{default:s(()=>[se]),_:1})]),w("div",oe,[a(e(E),{value:l.value,"onUpdate:value":r[1]||(r[1]=h=>l.value=h),size:"large",placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u7684\u5185\u5BB9",onKeydown:P(m,["enter"])},null,8,["value","onKeydown"])]),a(e($),{onClick:m,type:"primary",size:"large"},{default:s(()=>[ie]),_:1})]),_:1})]),_:1}))}});function re({_page:C=1,_size:g=5,Api:_=X,call:o}){const l=d(C),y=d(g),m=d([]),f=d(!1),r=d(0),h=d(0);return{page:l,size:y,list:m,count:r,pageCount:h,loading:f,handleGetList:async(N,t,u)=>{f.value=!0,o&&o.start();let n={page:N,size:y.value,q:t,state:u};if(!_){f.value=!1,o&&o.done(null);return}let v=await _(n);v.code?(m.value=v.data.list,r.value=v.data.count,h.value=Math.ceil(r.value/y.value),f.value=!1,o&&o.done(v)):(f.value=!1,o&&o.error(v))}}}const ce={key:0},ve=p("\u6807\u9898\uFF1A"),pe=p("\u7B80\u5355\u63CF\u8FF0"),ge=p("\u6807\u7B7E"),_e=p("\u94FE\u63A5"),fe=p("\u72B6\u6001"),he=p("\u4FEE\u6539"),me=p("\u65B0\u589E"),ye=S({props:{id:{type:Number,required:!0,default:0}},emits:["done"],setup(C,{emit:g}){const _=C,o=G(),l=d(),y=d([{label:"\u4E0A\u7EBF",value:"online"},{label:"\u5F85\u5BA1\u6838",value:"default"},{label:"\u5DF2\u5220\u9664",value:"del"}]),m=async t=>{if(t==0)l.value={title:"",desc:"",link:"",TagOptions:[],tagValue:[],create_time:0,id:0,type:"link",tag:[],update_time:0,state:"default"};else{let u=await Y({id:t});u.code==1&&f(u.data)}},f=t=>{let u=t.tag.map(n=>({label:n.title,value:n.id}));t.TagOptions=u,t.tagValue=u.map(n=>n.value),l.value=t,console.log(l.value)};W(()=>{m(_.id)});const r=async t=>{var n,v;let u=await te({q:t});if(u.code==1){let D=u.data.list.map(c=>({label:c.title,value:c.id})),T=(n=l.value)==null?void 0:n.TagOptions.map(c=>c.value),i=D.filter(c=>T.findIndex(F=>c.value==F)==-1);(v=l.value)==null||v.TagOptions.push(...i)}},h=t=>({id:t.id,title:t.title,desc:t.desc,link:t.link,state:t.state,tag:t.tagValue}),x=async()=>{let t=h(l.value),u=await Z(t);if(u.code!=1){o.warning(u.message);return}g("done")},N=async()=>{let t=await ee(h(l.value));if(t.code!=1){o.warning(t.message);return}g("done")};return(t,u)=>l.value?(k(),V("div",ce,[a(e(b),{vertical:""},{default:s(()=>[a(e(L),null,{default:s(()=>[ve]),_:1}),a(e(E),{value:l.value.title,"onUpdate:value":u[0]||(u[0]=n=>l.value.title=n),placeholder:"\u8BF7\u8F93\u5165\u6807\u9898"},null,8,["value"]),a(e(B),null,{default:s(()=>[pe]),_:1}),a(e(E),{value:l.value.desc,"onUpdate:value":u[1]||(u[1]=n=>l.value.desc=n),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u7B80\u5355\u63CF\u8FF0"},null,8,["value"]),a(e(B),null,{default:s(()=>[ge]),_:1}),a(e(U),{value:l.value.tagValue,"onUpdate:value":u[2]||(u[2]=n=>l.value.tagValue=n),multiple:"",options:l.value.TagOptions,filterable:"",onSearch:r},null,8,["value","options"]),a(e(B),null,{default:s(()=>[_e]),_:1}),a(e(E),{value:l.value.link,"onUpdate:value":u[3]||(u[3]=n=>l.value.link=n),placeholder:"\u8BF7\u8F93\u5165\u94FE\u63A5"},null,8,["value"]),a(e(B),null,{default:s(()=>[fe]),_:1}),a(e(U),{value:l.value.state,"onUpdate:value":u[4]||(u[4]=n=>l.value.state=n),options:y.value,size:"large",disabled:_.id==0},null,8,["value","options","disabled"]),_.id>0?(k(),z(e($),{key:0,type:"primary",block:"",onClick:x},{default:s(()=>[he]),_:1})):(k(),z(e($),{key:1,type:"primary",block:"",onClick:N},{default:s(()=>[me]),_:1}))]),_:1})])):O("v-if",!0)}}),Fe={class:"p-4 relative min-h-screen",id:"drawer-target"},we=p("\u8F6E\u5B50"),Be=p("\u65B0\u589E"),ke={class:"py-2"},Ce={key:0,class:"flex justify-center pt-4"},xe=S({setup(C){const g=d(!1),_=d(0),o=d([{title:"\u6807\u9898",key:"title"},{title:"\u6807\u7B7E",key:"tag",render(i){return i.tag.slice(0,5).map(F=>A(Q,{style:{marginRight:"6px"},type:"info"},{default:()=>F.title}))}},{title:"\u72B6\u6001",key:"state"},{title:"\u64CD\u4F5C",key:"setting",render(i){return A($,{size:"small",type:"success",onClick:()=>{D(i.id)}},{default:()=>"\u64CD\u4F5C"})}}]),l=I(()=>f.value),y=1,m=10,{list:f,page:r,size:h,pageCount:x,handleGetList:N}=re({_page:y,_size:m}),t=d({content:"",state:"online"}),u=i=>{t.value.content=i.content,t.value.state=i.state,v(1)},n=i=>{v(i)},v=async i=>{await N(i,t.value.content,t.value.state)},D=i=>{g.value=!0,_.value=i},T=()=>{g.value=!1,v(1)};return W(()=>{v(1)}),(i,c)=>(k(),V("div",Fe,[w("div",null,[a(e(b),null,{default:s(()=>[a(e(L),null,{default:s(()=>[we]),_:1}),a(e($),{type:"primary",onClick:c[0]||(c[0]=F=>D(0))},{default:s(()=>[Be]),_:1})]),_:1})]),a(e(K),null,{default:s(()=>[a(de,{onSelect:u})]),_:1}),w("div",ke,[a(e(M),{columns:o.value,data:e(l)},null,8,["columns","data"]),e(f).length>0?(k(),V("div",Ce,[a(e(H),{page:e(r),"onUpdate:page":c[1]||(c[1]=F=>R(r)?r.value=F:null),"page-size":e(h),"page-count":e(x),onUpdatePage:n},null,8,["page","page-size","page-count"])])):O("v-if",!0)]),a(e(j),{show:g.value,"onUpdate:show":c[2]||(c[2]=F=>g.value=F),width:"512px",placement:"right",to:"#drawer-target"},{default:s(()=>[a(e(J),null,{default:s(()=>[a(ye,{id:_.value,onDone:T},null,8,["id"])]),_:1})]),_:1},8,["show"])]))}});export{xe as default};
